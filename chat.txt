import fitz  # PyMuPDF

def check_embedded_files(pdf_path):
    # 打开PDF文件
    document = fitz.open(pdf_path)
    
    # 检查是否存在嵌入文件
    embedded_files = []
    for i in range(len(document)):
        page = document[i]
        annotations = page.annots()
        if annotations:
            for annot in annotations:
                if annot.type[0] == 21:  # 21 表示文件附件注释
                    embedded_files.append(annot.file)
    
    return embedded_files

# 指定PDF文件路径
pdf_path = 'example.pdf'

# 检查PDF文件中是否有嵌入文件
embedded_files = check_embedded_files(pdf_path)

if embedded_files:
    print(f"PDF 文件中有嵌入文件: {embedded_files}")
else:
    print("PDF 文件中没有嵌入文件")
