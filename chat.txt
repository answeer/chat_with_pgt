from llm_sanitation.scanners.scanner_base import Scanner
from llm_sanitation.utils.models import *
from llm_sanitation.utils.common import read_config


class BinTransform(Scanner):

    def __init__(self, **kwargs):
        self.default_catagory = kwargs["default"]
        self.catagories = kwargs["catagories"]
        super().__init__("bin_transform", None, catagories= kwargs["catagories"],
                                                default_catagory=kwargs["default"])

    def predict(self, value):
        try:
            for catagory in self._kwargs["catagories"]:
                lower, upper = catagory["range"]
                if lower <= value <= upper:
                    return catagory["name"]
        except Exception as e:
            print("Error occured: {}".format(e))
        return self._kwargs["default_catagory"]

    def format_response(self):
        self.response["prediction"]["catagory"] = self.pred
        self.response["score"] = None
