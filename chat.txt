from llm_sanitation.scanners.scanner_base import Scanner
from llm_sanitation.utils.models import *
from llm_sanitation.logging.logging_setup import LogUtil, LogType, LogLevel

class FormatCheck(Scanner):

    def __init__(self, **kwargs):
        format_list = kwargs["format_list"]
        super().__init__("format_check", 0.5, format_list=format_list)

    def predict(self, file):
        try:
            file_suffix = file.split('.')[-1]
            if file_suffix in self._kwargs['format_list']:
                score = 1
                predict = "valid format"
            else:
                score = 0
                predict = "invalid format"
        except Exception as e:
            predict = "Error occured: {}".format(e)
            score = 0
            LogUtil.log(LogType.ERROR, LogLevel.ERROR, e)

        return predict,score

    def format_response(self):
        self.response["prediction"]["format"] = self.pred[0]
        self.response["score"] = self.pred[1]
