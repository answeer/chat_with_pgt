def generate_payloads(input_payload, data):
    generated_payloads = []
    
    # 遍历所有数据类型（text/image/json等）
    for data_type in data:
        for item in data[data_type]:
            # 获取数据路径配置
            data_path = item['data'][0]
            
            # 处理通配符情况
            if data_path == "*":
                data_value = "*"
            else:
                # 解析常规参数路径 params.xxx
                param_key = data_path.split('.')[1]
                data_value = input_payload["service_params"]["job_object"].get(param_key)
            
            # 合并execution_plan步骤
            merged_plan = {}
            for step in item['execution_plan']:
                merged_plan.update(step)
            
            # 构建新payload
            new_payload = {
                "job_params": input_payload["job_params"],
                "service_params": {
                    "callback_url": input_payload["service_params"]["callback_url"],
                    "job_object": {
                        "io": input_payload["service_params"]["job_object"]["io"],
                        "policy_id": input_payload["service_params"]["job_object"]["policy_id"],
                        "data": data_value,
                        "execution_plan": merged_plan
                    }
                }
            }
            generated_payloads.append(new_payload)
    
    return generated_payloads
